Задача на парсинг данных SteamDB

Сайт https://steamdb.info/

Цель - собрать исторические данные относительно игр выпущенных, на Стиме: CCU & Price History. 
Для каких игр? 

Есть список из ~104 000 APP ID (игр), для которых нужна подобная выгрузка

APP ID должен совпадать с идентификатором приложения на SteamDB. Для того, чтобы на SteamDB найти определенное приложение с указанным APP ID необходимо в ссылку добавить 
https://steamdb.info/app/{APP_ID}/

Например, для Counter Strike 2 (730) достаточно перейти по ссылке https://steamdb.info/app/730/

CCU 
Для каждого App ID нам нужно собрать историю CCU - всю которая доступна c максимальной гранулярностью. Это означает, что если данные доступны раз в час, то нужно собрать данные за час; если же доступны данные только за день (особенно для какой-то далекой истории, то собираем данные за день. 

Чтобы посмотреть на данные CCU на странице игры, нужно перейти в раздел Charts. Здесь представлен график Players - это и есть то, что нам нужно. 

Нужно обязательно выбрать Max. В данном случае, нам нужны данные с 2012 года. 

Каким именно методом данные будут собраны - особо не имеет значения

Есть вариант авторизоваться и выкачать в файл данные по Players - он выдает данные в нужной гранулярностью. Через тул “Compare”, можно сделать это сразу для 10 приложений одновременно.

Формат результата

На выходе нужна таблица, где хранится история players для каждого app_id,  вида 

- app_id (APP ID)
- datetime (YYYY-MM-DD HH:MM:SS)
- players (x)

Price History
Для каждого приложения, нам также нужна история цены в валютах. 
Чтобы посмотреть цену, переходим в Price History на странице для App ID.
https://steamdb.info/app/730/

Нас интересует сбор валюты по каждой из валют, которые указаны в списке валют для игры.  

Для каждой валюты, SteamDB отображает график изменения цены. Нас интересует история lowest recorded price. 


Обязательно выбираем MAX - нам нужна полная история по каждой из валют. Достаточно сохранять данные или на каждый день или на дату изменения цены. 

По аналогии с CCU, способ как именно доставать не имеет значения - есть опция выгрузки цены в таблицу при авторизации. 

Формат результата

На выходе нужна таблица, где будут храниться данные по ценам для всех валют за всю историю для каждого app_id, вида:


datetime - За какой день указана цена 
price_final - Float - Значение цены в валюте страны
currency - Может быть символом валюты

app_id - (APP ID)
datetime - (YYYY-MM-DD HH:MM:SS)
price_final - (x)
currency_symbol - ($)
currency_name - (U.S. Dollar)



