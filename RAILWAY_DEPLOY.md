# –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø–∞—Ä—Å–µ—Ä–∞ –Ω–∞ Railway

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

–ü–∞—Ä—Å–µ—Ä —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ REST API! –í—ã –º–æ–∂–µ—Ç–µ —É–ø—Ä–∞–≤–ª—è—Ç—å –∏–º —É–¥–∞–ª–µ–Ω–Ω–æ —á–µ—Ä–µ–∑ HTTP –∑–∞–ø—Ä–æ—Å—ã.

**–û—Å–Ω–æ–≤–Ω—ã–µ endpoints:**
- `POST /start` - –∑–∞–ø—É—Å–∫ –ø–∞—Ä—Å–µ—Ä–∞ —Å —Ñ–∞–π–ª–æ–º app_ids
- `GET /status` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞
- `POST /stop` - –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä—Å–µ—Ä–∞
- `GET /export` - —ç–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API: [API_DOCUMENTATION.md](./API_DOCUMENTATION.md)

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Railway CLI** (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω):
```bash
npm i -g @railway/cli
```

2. **–í–æ–π–¥–∏—Ç–µ –≤ Railway**:
```bash
railway login
```

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Railway Dashboard (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ [railway.app](https://railway.app)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
3. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –≤–∞—à GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: `https://github.com/progprogect/steamids-parser.git`
4. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç Python –ø—Ä–æ–µ–∫—Ç –∏ –∑–∞–ø—É—Å—Ç–∏—Ç API —Å–µ—Ä–≤–µ—Ä
5. –î–æ–±–∞–≤—å—Ç–µ PostgreSQL —Å–µ—Ä–≤–∏—Å (New ‚Üí Database ‚Üí Add PostgreSQL)
6. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
   - `LOG_LEVEL=INFO`
   - `STEAMCHARTS_REQUESTS_PER_SECOND=100`
   - `STEAMCHARTS_MAX_CONCURRENT=80`
   - `PORT=5000` (Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç)

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ Railway CLI

```bash
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
railway init

# –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
railway up

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
railway logs

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–∏—Å—É
railway shell
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PostgreSQL –≤–º–µ—Å—Ç–æ SQLite –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**

1. –í Railway Dashboard ‚Üí –≤–∞—à –ø—Ä–æ–µ–∫—Ç ‚Üí **New** ‚Üí **Database** ‚Üí **Add PostgreSQL**
2. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `DATABASE_URL`
3. –ü–∞—Ä—Å–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç PostgreSQL –∏ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –≤–º–µ—Å—Ç–æ SQLite

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í Railway Dashboard ‚Üí Variables –¥–æ–±–∞–≤—å—Ç–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

```
LOG_LEVEL=INFO
STEAMCHARTS_REQUESTS_PER_SECOND=100
STEAMCHARTS_MAX_CONCURRENT=80
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** `DATABASE_URL` –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Railway –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PostgreSQL —Å–µ—Ä–≤–∏—Å–∞.

## –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

**–í–∞—Ä–∏–∞–Ω—Ç 1: PostgreSQL (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
- –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ PostgreSQL
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã Railway
- –õ—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç persistent volumes

**–í–∞—Ä–∏–∞–Ω—Ç 2: SQLite —Å persistent volumes**
- –í Railway Dashboard ‚Üí –≤–∞—à —Å–µ—Ä–≤–∏—Å ‚Üí Settings ‚Üí Volumes
- –î–æ–±–∞–≤—å—Ç–µ volume –¥–ª—è `/app/data`
- –≠—Ç–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API

–ü–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤–∞—à –ø–∞—Ä—Å–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `https://your-app.railway.app`

### –ó–∞–ø—É—Å–∫ –ø–∞—Ä—Å–µ—Ä–∞ —á–µ—Ä–µ–∑ API

```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª —Å app_ids
curl -X POST https://your-app.railway.app/start \
  -F "file=@app_ids.txt"
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

```bash
curl https://your-app.railway.app/status
```

### –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

```bash
# –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
curl https://your-app.railway.app/export?type=full

# –≠–∫—Å–ø–æ—Ä—Ç —Ç–æ–ª—å–∫–æ CCU –¥–∞–Ω–Ω—ã—Ö
curl -O https://your-app.railway.app/export?type=ccu

# –≠–∫—Å–ø–æ—Ä—Ç –æ—à–∏–±–æ–∫
curl -O https://your-app.railway.app/export?type=errors
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä—Å–µ—Ä–∞

```bash
curl -X POST https://your-app.railway.app/stop
```

–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [API_DOCUMENTATION.md](./API_DOCUMENTATION.md)

## –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã)

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ API (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/export` endpoint –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –≤—ã—à–µ.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –≠–∫—Å–ø–æ—Ä—Ç –∏–∑ PostgreSQL —á–µ—Ä–µ–∑ Railway CLI

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É
railway shell

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç–∫—Å–ø–æ—Ä—Ç (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç PostgreSQL)
python3 export_from_postgres.py

# –ò–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç
python3 export_full_results.py

# –§–∞–π–ª—ã –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –≤ /tmp/exports/ –∏–ª–∏ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
# –°–∫–∞—á–∞–π—Ç–µ –∏—Ö —á–µ—Ä–µ–∑ Railway Dashboard ‚Üí Volumes –∏–ª–∏ —á–µ—Ä–µ–∑ CLI
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä—è–º–æ–π SQL —ç–∫—Å–ø–æ—Ä—Ç –∏–∑ PostgreSQL

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ PostgreSQL —á–µ—Ä–µ–∑ Railway CLI
railway connect postgres

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ psql —Å DATABASE_URL
railway run psql $DATABASE_URL -c "\COPY (SELECT * FROM ccu_history) TO '/tmp/ccu_data.csv' CSV HEADER"
railway run psql $DATABASE_URL -c "\COPY (SELECT * FROM app_status WHERE status LIKE '%error%') TO '/tmp/errors.csv' CSV HEADER"
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ß–µ—Ä–µ–∑ Python —Å–∫—Ä–∏–ø—Ç —Å –ø—Ä—è–º—ã–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º

```bash
railway run python3 << 'EOF'
from database import Database
from export_steamcharts_csv import export_to_csv
from pathlib import Path

db = Database()
export_to_csv(db, Path("/tmp/results.csv"))
print("‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω: /tmp/results.csv")
EOF
```

### –í–∞—Ä–∏–∞–Ω—Ç 4: –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Railway Dashboard

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç–∫—Å–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ Railway shell
2. –§–∞–π–ª—ã –±—É–¥—É—Ç –≤ `/tmp/exports/` –∏–ª–∏ `/app/data/`
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Railway Dashboard ‚Üí Volumes –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- **–õ–æ–≥–∏**: Railway Dashboard ‚Üí –≤–∞—à —Å–µ—Ä–≤–∏—Å ‚Üí Logs
- **–ú–µ—Ç—Ä–∏–∫–∏**: Railway Dashboard ‚Üí –≤–∞—à —Å–µ—Ä–≤–∏—Å ‚Üí Metrics
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞**: `railway run python3 check_progress.py`

## –û—Å—Ç–∞–Ω–æ–≤–∫–∞/–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å
railway service stop

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å
railway service start

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
railway service restart
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ PostgreSQL** –≤–º–µ—Å—Ç–æ SQLite –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ –æ–±–ª–∞–∫–µ:
   - –î–æ–±–∞–≤—å—Ç–µ PostgreSQL —Å–µ—Ä–≤–∏—Å –≤ Railway
   - –ò–∑–º–µ–Ω–∏—Ç–µ `database.py` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è PostgreSQL

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ—ç–∫—Å–ø–æ—Ä—Ç**:
   - –î–æ–±–∞–≤—å—Ç–µ cron job –¥–ª—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–≥–æ —ç–∫—Å–ø–æ—Ä—Ç–∞
   - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Railway Cron –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞

3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**:
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–ª–µ—Ä—Ç—ã –≤ Railway
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `check_progress.py` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞

4. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å—Ç–æ–∏–º–æ—Å—Ç–∏**:
   - Railway –≤–∑–∏–º–∞–µ—Ç –ø–ª–∞—Ç—É –∑–∞ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã
   - –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞ –ø–∞—Ä—Å–µ—Ä–∞ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏, –∞ –Ω–µ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ

## –ü—Ä–∏–º–µ—Ä –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

–°–æ–∑–¥–∞–π—Ç–µ `run_once.py`:

```python
#!/usr/bin/env python3
"""–ó–∞–ø—É—Å–∫ –ø–∞—Ä—Å–µ—Ä–∞ –æ–¥–∏–Ω —Ä–∞–∑ —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º —ç–∫—Å–ø–æ—Ä—Ç–æ–º"""
from parser import SteamDBParser
from export_full_results import main as export_main

parser = SteamDBParser()
parser.run()

# –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è - —ç–∫—Å–ø–æ—Ä—Ç
export_main()
```

–ó–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Railway Cron –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é.

